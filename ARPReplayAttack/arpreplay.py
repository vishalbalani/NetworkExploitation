#!/usr/bin/env python
import subprocess
import optparse
import re
import sys

def get_arguments():
    parser = optparse.OptionParser()

    parser.add_option("-i", "--interface", dest="interface", help="Network Interface")
    parser.add_option("-b", "--bssid", dest="bssid", help="BSSID of Wifi Network")
    parser.add_option("-m", "--mac", dest="mac", help="MAC Address")

    (options, arguments) = parser.parse_args()
    if not options.interface:
        parser.error("[.] Please specify an interface, use --help for more info")
    return options


def arpreplay(interface, bssid, mac):

    try:

        subprocess.call("aireplay-ng --arpreplay -b  " + bssid + " -h " + mac + " " + interface, shell=True)


    except KeyboardInterrupt:
        print("[-] Scan Stopped by user ")
        subprocess.call("systemctl start NetworkManager.service", shell=True)
        sys.exit()


options = get_arguments()
arpreplay(options.interface, options.bssid, options.mac)
